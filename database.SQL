   
CREATE DATABASE paymentv2;
USE paymentv2;

CREATE TABLE REGISTERS(
    ID_REGISTER INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    DATE DATE NOT NULL,
    ID_USER INT NOT NULL,
    ID_STATUS INT NOT NULL,
    ID_SERVICE INT NOT NULL
);

CREATE TABLE STATUS(
    ID_STATUS INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    STATUS VARCHAR(150) NOT NULL
);

CREATE TABLE USERS(
    ID_USER INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    NAME VARCHAR(150) NOT NULL,
    LAST_NAME VARCHAR(150) NOT NULL,
    ID_TYPE INT NOT NULL
);

CREATE TABLE USERS_TYPES(
    ID_TYPE INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    TYPE VARCHAR(150) NOT NULL
);

CREATE TABLE SERVICES(
    ID_SERVICE INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    NAME VARCHAR(150) NOT NULL,
    PRICE DECIMAL(10,2) NOT NULL,
    ID_USER INT NOT NULL
);

ALTER TABLE `USERS`
  ADD KEY `ID_TYPE` (`ID_TYPE`),
  ADD CONSTRAINT `USERS_ibfk_1` FOREIGN KEY (`ID_TYPE`) REFERENCES `USERS_TYPES` (`ID_TYPE`) ON UPDATE CASCADE;

ALTER TABLE `SERVICES`
  ADD KEY `ID_USER` (`ID_USER`),
  ADD CONSTRAINT `SERVICES_ibfk_1` FOREIGN KEY (`ID_USER`) REFERENCES `USERS` (`ID_USER`) ON UPDATE CASCADE;

ALTER TABLE `REGISTERS`
    ADD KEY `ID_USER` (`ID_USER`),
    ADD KEY `ID_STATUS` (`ID_STATUS`),
    ADD KEY `ID_SERVICE` (`ID_SERVICE`),
    
    ADD CONSTRAINT `REGISTERS_ibfk_1` FOREIGN KEY (`ID_USER`) REFERENCES `USERS` (`ID_USER`) ON UPDATE CASCADE,
    ADD CONSTRAINT `REGISTERS_ibfk_2` FOREIGN KEY (`ID_STATUS`) REFERENCES `STATUS` (`ID_STATUS`) ON UPDATE CASCADE,
    ADD CONSTRAINT `REGISTERS_ibfk_3` FOREIGN KEY (`ID_SERVICE`) REFERENCES `SERVICES` (`ID_SERVICE`) ON UPDATE CASCADE;

COMMIT;
